<?xml version="1.0" encoding="iso-2022-jp"?>
<!DOCTYPE html 
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<head>
<meta http-equiv="content-type" content="text/html;charset=iso-2022-jp" />
<meta http-equiv="content-style-type" content="text/css" />
<title>qmail-smtpd extention</title>
<link rev="made" href="mailto:taki@cyber.email.ne.jp" />
<link rel="stylesheet" href="vida.css" />
<body>
<h1>qmail-smtpd の拡張機能</h1>
<p>qmail-smtpdがqmail-vidaパッケージにより拡張された機能を示す。</p>

<h2>controlファイル</h2>
<h3>control/senderhosts</h3>
<p>認証に成功したり、環境変数 RELAYCLIENT が設定されていたりして中継が許可されたときでも、このファイルがある場合は、envelope sender のドメイン部がこのファイルに記述されたドメインに一致しなければ中継を拒否する。</p>
<p>組織において送信者のメールアドレスのドメインを厳しく制限したい場合などに利用する。ただし、null sender の場合は DSN(Delivery Status Notifications) の絡みもあってこの機能は無効になる。</p>
<p>次の例のように１行に１つのドメインのFQDNを記述する。</p>
<pre class="example">
  example.org
  example.net
</pre>

<h3>control/badrcptto</h3>
<p>このファイルに記述されたメールアドレス宛のメッセージの受取りを拒否する。</p>
<p>次の例のように１行に１つのメールアドレスを記述する。</p>
<pre class="example">
  foo@example.org
  bar@example.org
</pre>

<h2>環境変数</h2>
<h3>TEMPRELAYCLIENT</h3>
<p>環境変数 RELAYCLIENT が設定されていなければ、認証の成功後に環境変数 TEMPRELAYCLIENT は RELAYCLIENT と同じ役割を行う。</p>
<p>qmail の FAQ 5.5 と同じことを行いたければ RELAYCLIENT を設定する代わりに次のように起動ファイルあるいは tcpserver のアクセス制御ファイルの環境変数の設定場所に TEMPRELAYCLIENT を設定する。</p>
<pre class="example">
  TEMPRELAYCLIENT="@fixme"
</pre>

<h3>SENDERHOSTS</h3>
<p>環境変数 SENDERHOSTS が設定されている場合、control/senderhosts の設定を上書きする。</p>
<p>次の例のようにコロン区切りでドメインのFQDNを並べる。</p>
<pre class="example">
  SENDERHOSTS='example.org:example.net'
</pre>

<h3>RCPTHOSTS</h3>
<p>環境変数 RCPTHOSTS が設定されている場合、control/rcpthosts の設定を上書きする。これと同時に、認証に成功したり、環境変数 RELAYCLIENT が設定されていたりして中継が許可されたときでも、中継の許可を無効にし、RCPTHOSTS に記述されたドメイン宛てのメッセージしか受け取らない。</p>
<p>組織において特定のユーザからのメッセージを外部のドメインに送信させたくない場合などに利用する。特定のユーザ毎に環境変数を設定する方法は <a href="vida-passwd.html">vida-passwdのマニュアル</a>を参照。</p>
<p>次の例のようにコロン区切りでドメインのFQDNを並べる。</p>
<pre class="example">
  RCPTHOSTS='example.org:example.net'
</pre>

</body>
</html>
