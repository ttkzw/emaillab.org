<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
<head>
<title>MUAs for Windows - Storage of mail messages</title>
<meta http-equiv="content-type" content="text/html;charset=iso-2022-jp">
<meta http-equiv="content-style-type" content="text/css">
<link rev="made" href="mailto:taki@cyber.email.ne.jp">
<link rel="stylesheet" href="../taki.css">
</head>
<body lang="ja">
<h1>Windows のメイラーの選定</h1>
<h2>メッセージの格納形式</h2>
<p>1999年5月20日初出</p>
<hr>
<h3>目次</h3>
<ul>
<li><a href="#at_first">はじめに</a>
<li><a href="#storage">格納方式</a>
<li><a href="#mailbox">mailbox 形式</a>
</ul>

<hr>
<h3><a name="at_first">はじめに</a></h3>
<p>
「あなたの使っているメイラーのメッセージの格納方式は何ですか？」と聞かれて答えられる人はどの程度いるのだろうか？  それほど多くはいないと思う。なぜなら、そのようなことは知らなくてもメイルのやりとりは出来るからだ。しかし、メッセージの格納方式がメイラーの性能やメッセージの安全性に多いに影響があるということを知ったら、そんなに無関心ではいられないと思う。そこで、このページではメッセージの格納方式についてまとめてみることにする。
</p>

<hr>
<h3><a name="storage">格納方式</a></h3>
<p>メッセージの格納方式には次のようなものがある。</p>
<ol>
<li>一つのファイルに複数のメッセージを格納する方式。<br>
    メイラーのツリー画面等におけるフォルダーが実際のファイルに相当する。
<li>一つのファイルに一つのメッセージを格納する方式。<br>
    メイラーのツリー画面等におけるフォルダーが実際のディレクトリに相当する。
<li>データベースとして格納する方式。
</ol>
<p>1 の方法は一般に mbox 形式とか呼ばれ、よく用いられているものだ。ここでは mailbox 形式と呼ぶことにする。2 の方法は mh 形式とか、Maildir 形式とか様々な呼ばれ方がされている。ここでは maildir 形式と呼ぶことにする。なお、mailbox, maildir という呼び方は一般的にそう呼ばれているわけではなく、ここだけの呼び方なので注意してほしい。3 の方法はほとんど見かけない、というか筆者自身はよく知らない。ただ、可能性としてありえるのでここに列記した。ここでは、この形式に関しては議論しない。
</p>

<hr>
<h3><a name="mailbox">mailbox 形式</a></h3>
<p>mailbox 形式の特徴は先の説明のとおり「一つのファイルに複数のメッセージを格納する方式」である。そのため、どこからどこまでが一つのメッセージであるかを識別する方法を実装する必要がある。この識別方法には様々なものがあり、異なるメイラー間では必ずしも互換性があるわけではない。さらには、メイラー固有の情報などを付け加えたり、添付ファイルを別に格納して mailbox から取り除いたりするものもある。なおさらである。</p>
<p>それでは、他のメイラーに移行するとき困るのではないかと考えるが、大抵のメイラーは他の形式のファイルとして出力したり、取り込んだりする機能がある。その形式の代表格なのが UNIX の mbox 形式である。"From " で始まる行から、次の "From " で始まる行までを一つのメッセージとする方式である。しかし、本文中に "From " で始まる行があると誤認識するので、ヘッダーに "Content-Length" フィールドを挿入してメッセージの長さを指定したり、"From " の前に ">" を挿入したりする方法が併用されている。そのため、実は mbox 形式も様々な実装があるので必ずしも互換性があるわけではないことがわかる。また、メッセージに手を加えるため、電子署名を行った場合には改ざんされたとみなされてしまう可能性がある。</p>

<h4>mailbox 形式の長所</h4>
<ol>
<li>ファイルシステムの管理情報をあまり消費しない。
<li>ディスク容量を無駄に消費しない。
</ol>
<p>これは、一ファイル/複数メッセージであるがゆえに、使用するファイルの数が少ないためファイルシステムの管理情報が少なくて済み、また、クラスタギャップなどはあまり生じないためである。
</p>

<h4>mailbox 形式の短所</h4>
<ol>
<li>メッセージを失う危険性が高い。
<li>オリジナルのメッセージのまま格納されないことが多い。
<li>振り分け、移動、削除などのメッセージに対する操作が遅い。
</ol>


<hr>
<h3><a name="maildir">maildir 形式</a></h3>


<hr>
<address>
滝澤 隆史(TAKIZAWA Takashi)<br>
<a href="mailto:taki@cyber.email.ne.jp">taki@cyber.email.ne.jp</a>
</address>
<hr>
<p class="footmenu">
<a href="index.html">目次</a> - 
<a href="first.html">はじめに（選定条件など）</a> - 
<a href="selected.html">選定したメイラ─</a> - 
<a href="problem.html">メイラ─の問題点</a> - 
<a href="table.html">一覧表</a> - 
<a href="table-mailer.html">評価したメイラ─の一覧</a>
</p>
</body>
</html>
