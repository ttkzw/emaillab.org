<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.20">
 <TITLE>The Mutt E-Mail Client : 高度な使い方</TITLE>
 <LINK HREF="manual_ja-5.html" REL=next>
 <LINK HREF="manual_ja-3.html" REL=previous>
 <LINK HREF="manual_ja.html#toc4" REL=contents>
</HEAD>
<BODY>
<A HREF="manual_ja-5.html">次のページ</A>
<A HREF="manual_ja-3.html">前のページ</A>
<A HREF="manual_ja.html#toc4">目次へ</A>
<HR>
<H2><A NAME="s4">4.</A> <A HREF="manual_ja.html#toc4">高度な使い方</A></H2>

<H2><A NAME="regexp"></A> <A NAME="ss4.1">4.1</A> <A HREF="manual_ja.html#toc4.1">正規表現</A>
</H2>

<P>複雑なパターン
<A HREF="#patterns">patterns</A>も含めて Mutt で文字列を検索するには POSIXで拡張された形の正規表現を指定しなければなりません。(拡張正規表現の文法は
egrepとGNU awkでも多少採り入れられています)。この文法の簡単に説明しておきましょう。</P>
<P>検索パターンが一つでも大文字を含めば大文字小文字を区別して検索が行われます、それ以外は大文字小文字を区別しません。初期化コマンドの中で
\ を正規表現に使いたい場合、\ は \\ という風にエスケープされなければなりませ
ん。</P>
<P>正規表現は文字列のセットを記述するためのパターンです。正規表現は数学の式の組み立てと似ており、小さな式を組み合わせるのに色々な演算子を使いま
す。</P>
<P>正規表現を囲んだり、分けたりするのに &quot; と ' が使えます。これは正規表現が空白文字を含む場合に便利です。&quot;
と 'がどのように処理されるかについての詳しい説明は 
<A HREF="manual_ja-3.html#muttrc-syntax">初期化ファイルの構文</A>にあります。またこれらはそのまま（特殊文字ではなく）リテラルとして正規表現に含めたい場合には前に\（バックスラッシュ）をつけてください。</P>
<P>基本となる単位は1つの文字にマッチする正規表現であり、アルファベットとアラビア数字の全てを含むほとんどの文字はその文字そのものがそれ自身にマッチする正規表現です。特殊な意味を持つメタキャラクターは前にバックスラッシュを付けることでエスケープします。</P>
<P>ピリオド(.)は任意の1文字にマッチします。カレット(^)とドル記号($)はそれぞれ行の最初と最後という概念的な文字(行の最初にある一文字を表すのではなく行の最初という概念的なものを表す正規表現です)にマッチするメタキャラク
ターです。</P>
<P>[ と ] で囲まれた文字のリストはその中にある文字のどれかにマッチします。もしリストの最初にカレット(^)があればそのリストにない文字にマッチします。例えば
[0123456789]はアラビア数字のうちのどれかにマッチします。ASCII文字を指定する場合最初の文字と最後の文字の間にハイフン(-)を置くことで範囲指定することができます。ほとんどのメタキャラクターはリストの中ではその意味を失います。]そのものをリストの中に置きたい場合はリストの最初に置きます。同様に
^ そのものをリストの中に置きたい場合はリストの最初以外の場所に置きます。そしてハイフン(-)を置きたい場合はリストの最後に置きます。</P>
<P>特定の文字クラスは前もって定義してあります。文字クラスは、[:
、そのクラスを表すキーワード、:] 、で構成されます。次に示すクラスは
POSIX 標準で定められているものです。</P>
<P>
<DL>
<DT><B>[:alnum:]</B><DD><P>アルファベットとアラビア数字</P>
<DT><B>[:alpha:]</B><DD><P>アルファベット</P>
<DT><B>[:blank:]</B><DD><P>スペースとタブ</P>
<DT><B>[:cntrl:]</B><DD><P>制御文字</P>
<DT><B>[:digit:]</B><DD><P>アラビア数字</P>
<DT><B>[:graph:]</B><DD><P>印字可能かつ見える文字(スペースは印字可能であるが見えない。一方
a は印字可能かつ見える文字)</P>
<DT><B>[:lower:]</B><DD><P>アルファベットの小文字</P>
<DT><B>[:print:]</B><DD><P>印字可能な文字(制御文字以外)</P>
<DT><B>[:punct:]</B><DD><P>句読点(アルファベット、アラビア数字、制御文字、スペース以外の文字)</P>
<DT><B>[:space:]</B><DD><P>空白文字(スペース、タブ、改ページ等)</P>
<DT><B>[:upper:]</B><DD><P>アルファベットの大文字</P>
<DT><B>[:xdigit:]</B><DD><P>16進数</P>
</DL>
</P>
<P>文字クラスは角括弧で囲まれた文字リストの中でのみ有効です。文字クラス名にある角括弧は記号名の一部だということに注意して下さい。つまり、文字リストを定義する角括弧とは別に角括弧で囲まれなければなりません。例えば:
[[:digit:]] は [0-9] と同義です。</P>
<P>文字リストの中ではさらに2つの特別なシークエンスがあり、これらで照合要素と呼ばれる複数の文字を表す一つの記号を使ったり、同じように文字を照合したりソートしたりするために等価ないくつかの文字を一つの記号で表したりすることで
ASCII 以外の文字セットも利用できるようになっています。</P>
<P>
<DL>
<DT><B>照合記号</B><DD><P>照合記号は [. と .] で括られた複数の文字を参照する要素です。例えば、ch
が照合要素だとすると [[.ch.]] がこの照合要素にマッチする正規表現です。一方
[ch] は c か h のどちらかにマッチする正規表現です。</P>
<DT><B>等価クラス</B><DD><P>等価クラスとは各々のロケール固有のよく似ていて同一視できる文字のリストの名前です。名前は
[= と =] で括ります。例えば、e という名前がアルファベットの
eとアクセント付の eの全てを表すものとして使われているとします。この場合
[[=e=]] は e、アクセント付の eのどれかにマッチする正規表現です。</P>
</DL>
</P>
<P>一つの文字にマッチする正規表現は下に示す繰り返し演算子を後に付けることができます。</P>
<P>
<DL>
<DT><B>?</B><DD><P>直前の正規表現が一つもないか一つ</P>
<DT><B>*</B><DD><P>直前の正規表現の0回以上の繰り返し</P>
<DT><B>+</B><DD><P>直前の正規表現の1回以上の繰り返し</P>
<DT><B>{n}</B><DD><P>直前の正規表現のn回の繰り返し</P>
<DT><B>{n,}</B><DD><P>直前の正規表現のn回以上の繰り返し</P>
<DT><B>{,m}</B><DD><P>直前の正規表現の0回以上m回までの繰り返し</P>
<DT><B>{n,m}</B><DD><P>直前の正規表現のn回以上m回までの繰り返し</P>
</DL>
</P>
<P>二つの正規表現をそのままつなぐこともできます。つないでできた一つの正規表現はつなげた二つの正規表現がそれぞれマッチする二つの文字列をあわせた一つの文字列にマッチします。</P>
<P>二つの正規表現は選択演算子 | でつなぐことができ、二つをつないでできる一つの正規表現は二つの正規表現の内のどちらかがマッチする文字列にマッチし
ます。</P>
<P>繰り返し演算子と正規表現とのつながりは正規表現同士のつながりよりも優先します。選択演算子でつながれた正規表現の後に繰り返し演算子がくると、繰り返し演算子が選択演算子に対して優先しますので、どちらかの正規表現の繰り返しを表します。正規表現同士を括弧
() で括ってしまえば繰り返し演算子より優先させ ることができます</P>
<P><B>注意</B>: Mutt を GNU rx パッケージと共にコンパイルしていれば次の演算子を正規
表現の中で使うこともできます。</P>
<P>
<DL>
<DT><B>\\y</B><DD><P>単語の先頭か最後という概念的な文字ににマッチします</P>
<DT><B>\\B</B><DD><P>単語内という概念的な文字にマッチします</P>
<DT><B>\\&lt;</B><DD><P>単語の先頭という概念的な文字にマッチします</P>
<DT><B>\\&gt;</B><DD><P>単語の最後という概念的な文字にマッチします</P>
<DT><B>\\w</B><DD><P>単語を構成する任意の文字にマッチします(アルファベット、アラビア
数字、アンダースコア)</P>
<DT><B>\\W</B><DD><P>単語の成分以外の任意の文字にマッチします。</P>
<DT><B>\\`</B><DD><P>バッファの先頭という概念的な文字列にマッチします(文字列)</P>
<DT><B>\\'</B><DD><P>バッファの最後という概念的な文字列にマッチします</P>
</DL>
</P>
<P>しかしながらこれらの演算子は POSIX では定められておらず、そのため様々なシステムのストックライブラリでは使えたり使えなかったりする、ということに注意して下さい。</P>
<H2><A NAME="patterns"></A> <A NAME="ss4.2">4.2</A> <A HREF="manual_ja.html#toc4.2">パターン</A>
</H2>

<P>多くの Muttコマンドではマッチさせるパターンを指定することができます
(limit、タグパターン、削除パターン、etc)。複数のメールを選択するのにもいくつかの方法があります:</P>
<P>
<PRE>
~A              全てのメール
~b EXPR         本文に EXPR を含むメール
~B EXPR         EXPR を含むメール
~c USER         CC に USER が宛てられているメール
~C EXPR         To: か Cc: に EXPR を含むメール
~D              削除マークが付けられたメール
~d [MIN]-[MAX]  送信された日付けがその範囲の中にあるメール
~E              エクスパイアされているメール
~e EXPR         Sender フィールドに EXPR を含むメール
~F              重要のマークがついているメール
~f USER         USERから出されたメール
~g              PGP 署名されているメール
~G              PGP 暗号化されているメール
~h EXPR         ヘッダーに EXPR を含むメール
~k              PGP鍵を含んだメール
~i ID           Message-ID フィールドで ID にマッチするメール
~L EXPR         EXPR から出されているか EXPR に届いているメール
~l              メーリングリストに指定されているアドレスにマッチするメール
~m [MIN]-[MAX]  MIN から MAX の範囲のメール
~n [MIN]-[MAX]  MIN から MAX の範囲のスコアのメール
~N              新着のメール
~O              古い未読メール
~p              あなたに宛てられたメール
~P              あなたが出したメール
~Q              返信済のメール
~R              既読のメール
~r [MIN]-[MAX]  受信日がその範囲にあるメール
~S              置き換えられたメール
~s SUBJECT      Subject フィールドに SUBJECT を持つメール
~T              タグ付けされたメール
~t USER         USER宛のメール
~U              未読のメール
~v              折り畳んだスレッドに含まれるメール
~x EXPR         References フィールドに EXPR を含むメール
~y EXPR         X-Labelフィールドに EXPRを持つメッセージ 
~z [MIN]-[MAX]  サイズが MIN から MAX の間のメール *)
~=             重複したメッセージ ($duplicate_threads を見てください)
</PRE>
</P>
<P>EXPR、USER、ID、SUBJECTは正規表現
<A HREF="#regexp">regular expressions</A>です。</P>
<P>*) &lt;[MAX]、 &gt;[MIN]i、 [MIN]-、-[MAX]
という書き方もできます。</P>
<H3>パターン修飾子</H3>

<P>アドレスのリストに対してパターンマッチングを行う場合は（特に
c、C、p、P、t）、リストの中に一つでもパターンにマッチするアドレスがあると、そのリスト全体が選ばれてしまうことに注意してください。もしそのリストのすべての要素がパターンにマッチするリストを選びたい場合はパターンの前に^を前置する必要があります。次の例はすべての受取人がドイツいるメールにマッチします。</P>
<P>
<PRE>
^~C \.de$  
</PRE>
</P>
<H3>組み合わせて検索する</H3>

<P>AND 検索は一つ以上の基準を記述することで行われます。例えば:</P>
<P>
<PRE>
~t mutt ~f elkins  
</PRE>
</P>
<P>は受信者のリストに muttという単語を含み、かつ From ヘッダーフィールドに
elkins という単語を持つメールを選択します。</P>
<P>Mutt では次にあげる演算子も利用でき、もっと複雑な検索パターンを指定することができます:</P>
<P>
<UL>
<LI>! -- 論理 NOT 演算子</LI>
<LI>| -- 論理 OR 演算子</LI>
<LI>() -- 論理グループ化演算子</LI>
</UL>
</P>
<P>組合わせ検索の例をいくつか見てみましょう。次のパターンは To もしくは
Cc フィールドに mutt を含まず、かつ From が elkins であるメールを選び出します。</P>
<P>
<PRE>
!(~t mutt|~c mutt) ~f elkins  
</PRE>
</P>
<P>次の例は空白を正規表現に含める例です（'か &quot;をつかいます）。これはメールのサブジェクトに
``Junk +From +Me$''が含まれ、``Jim +Somebody''または ``Ed
+SomeoneElse''から来たメッセージにマッチします。</P>
<P>
<PRE>
'~s &quot;^Junk +From +Me$&quot; ~f (&quot;Jim +Somebody&quot;|&quot;Ed +SomeoneElse&quot;)'
</PRE>
</P>
<H3>日付で検索する</H3>

<P>Mutt は絶対的な日付と相対的な日付という二つの日付のタイプをサポートしています。</P>
<P><B>絶対的</B>な日付。 日付は DD/MM/YY という形式で指定しなければなりません(月と年は省略することができます、省略された場合は現在の月と年とみなされます)。正しい日付の範囲指定の例を挙げます:</P>
<P>
<PRE>
Limit to messages matching: ~d 20/1/95-31/10  
</PRE>
</P>
<P>もし選択しようとする日付の範囲の最初の日付を省略して -DD/MM/YYとだけ指定した場合その日付以前のメールが全て選択されます。最後の日付を省略して
DD/MM/YY- とのみ指定した場合はその日付以降のメールが選択されます。ダッシュ(-)なしで一つの日付を指定した場合はその日付に送られたメールだけが選択されます。</P>
<P><B>エラーマージン</B>  エラーマージンを絶対的な日付に加えることができます。エラーマージンは（+または-の）符号、数字、単位からなっています。使える単位は次の通りです。</P>
<P>
<PRE>
y       年  
m       月 
w       週 
d      日。この場合は特別に符号に「*」を使うことができます。これは正と負に同じだけのエラーマージンを与えます。
</PRE>
</P>
<P>例: 2001年1月15日前後二週間ずつのメッセージを選択するためには、次のようなパターンを使います。</P>
<P>
<PRE>
Limit to messages matching: ~d 15/1/2001*2w
</PRE>
</P>
<P><B>相対的</B>な日付。 このタイプの日付は現在の日付に対する相対的なものです。そして次のような指定の仕方ができます:</P>
<P>
<UL>
<LI>&gt;offset (offset 単位よりも古いメール)</LI>
<LI>&lt;offset (offset 単位よりも新しいメール)</LI>
<LI>=offset (正確に offset 単位の分古いメール)</LI>
</UL>
</P>
<P>offset は次の単位が後に続く正の数です。</P>
<P>
<PRE>
y      年
m      月
w      週
d      日
</PRE>
</P>
<P>例: 一ヵ月以上は古くないメールを選択するには次のようにします。</P>
<P>
<PRE>
Limit to messages matching: ~d &lt;1m  
</PRE>
</P>
<P><B>注意</B>: 検索の時に使われる日付はすべてローカル時間に対する相対的なものです。ですから
<A HREF="manual_ja-6.html#index_format">$index_format</A> が %[...] フォーマットを含むように設定を変更しない限りインデックスで表示される日付がこれにマッチするというわけではありません。</P>
<H2><A NAME="ss4.3">4.3</A> <A HREF="manual_ja.html#toc4.3">タグを使う</A>
</H2>

<P>メールを一度に一通づつよりもまとめて操作をしたい場合があります。例えば、あるメーリングリスト宛てのメールを別のフォルダーに保存したり、与えた
Subject を含む全てのメールを削除する場合などです。パターンにマッチしたメールにタグをつけるには
tag-pattern機能を使います(デフォルトで shift-Tに割り当てられています)。もしくは
tag-message機能(デフォルトで t に割り当てられています)を使うことで個々のメールを手動でタグをつけることもできます。パターンの文法については検索の章
<A HREF="#patterns">patterns</A>を参照して下さい。</P>
<P>いったん望むメールにタグをつけたら tag-prefix演算子(デフォルトでセミコロン(;)キー)を使います。tag-prefix
演算子が使われると、その次の操作でタグをつけたすべてのメールに対して(その操作が正しい操作であれば)その操作が行われます。
<A HREF="manual_ja-6.html#auto_tag">$auto_tag</A>変数がセットされていると、tag-prefix演算子を使うこと無しに次の操作が自動的にタグつけされたメールに施されます。</P>
<H2><A NAME="hooks"></A> <A NAME="ss4.4">4.4</A> <A HREF="manual_ja.html#toc4.4">フックを使う</A>
</H2>

<P>フックの概念は EMACSエディターから借りてきたもので、これを使うことでなんらかの操作をする前に任意のコマンドを実行することができるようになります。例えば、読んでいるメールボックスや送るメールのあて先に応じてなんらかの設定を変えたいような場合です。Muttの世界ではフックは正規表現
<A HREF="#regexp">regular expression</A>かパターン
<A HREF="#patterns">pattern</A>と設定オプション/コマンドで構成されます。使うことができるフックコマンドの詳細は次のセクションを見てください。</P>
<P>
<UL>
<LI>
<A HREF="manual_ja-3.html#folder-hook">folder-hook</A></LI>
<LI>
<A HREF="manual_ja-3.html#send-hook">send-hook</A></LI>
<LI>
<A HREF="manual_ja-3.html#message-hook">message-hook</A></LI>
<LI>
<A HREF="manual_ja-3.html#save-hook">save-hook</A></LI>
<LI>
<A HREF="manual_ja-3.html#mbox-hook">mbox-hook</A></LI>
<LI>
<A HREF="manual_ja-3.html#fcc-hook">fcc-hook</A></LI>
<LI>
<A HREF="manual_ja-3.html#fcc-save-hook">fcc-save-hook</A> </LI>
</UL>
</P>
<P><B>Note:</B> もしフックが設定に変更を加えた場合には、その変更は今動かしている
muttセッションの終りまで有効になります。これを避けて、設定をデフォルトに戻すためにはすべてフックの前にデフォルトフックを置く必要があります。次の例は
send-hookと my_hdrを使った例です。</P>
<P>
<PRE>
send-hook . 'unmy_hdr From:'  
send-hook ~Cb@b.b my_hdr from: c@c.c
</PRE>
</P>
<H3><A NAME="pattern_hook"></A> フックコマンドでメールにマッチさせる</H3>

<P>メールに応じて実行するフックコマンド(send-hook、save-hook、fcc-hook、message-hook)は他のフックコマンドと少し違った方法で評価されます。他のタイプのフックコマンドは正規表現
<A HREF="#regexp">regular expression</A>で十分です。しかしメールを扱うときはもう少しきめの細かいマッチングが必要になります。というのも、さまざまな基準で、またさまざまな目的でマッチさせたい場合があるからです。</P>
<P>Muttではフックコマンドでメールをマッチさせるには検索パターン言語
<A HREF="#patterns">search pattern</A>を使うことができます。これは、メールのへッダに関する情報にマッチする演算子に制限されること以外は、メールボックスを絞り込んだり検索したりするのと全く同じように動作します。</P>
<P>例えば、返信先のアドレスを特定の宛先に対してセットしたい場合は次のようにすることができます:</P>
<P>
<PRE>
send-hook '~t ^me@cs\.hmc\.edu$' 'my_hdr From: Mutt User &lt;user@host&gt;'  
</PRE>
</P>
<P>これは me@cs.hmc.edu 宛てにメールを送るときに実行されます。</P>
<P>しかしながら、マッチさせるパターンを書くときに検索言語を完全な形式で書くことが要求されるわけではありません。他のフックコマンドのように単純に正規表現で指定することもできます。そうされた場合
Mutt は 
<A HREF="manual_ja-6.html#default_hook">$default_hook</A>変数に指定されている値を元にパターンの完全な形を推測して実行します。パターンの完全な形への変換はフックコマンドが宣言されたときに行われますので、その時に有効な
<A HREF="manual_ja-6.html#default_hook">$default_hook</A>の値が使われます。</P>
<H2><A NAME="query"></A> <A NAME="ss4.5">4.5</A> <A HREF="manual_ja.html#toc4.5">外部にアドレスを問い合わせる</A>
</H2>

<P>Mutt は LDAP や ph/qi や bbdb や NIS といった外部のディレクトリーデータベースへ、単純なインターフェイスを使ったラッパースクリプトを通して接続できます。
<A HREF="manual_ja-6.html#query_command">$query_command</A>変数を使って利用するラッパースクリプトを指定します。例えば:</P>
<P>
<PRE>
set query_command = &quot;mutt_ldap_query.pl '%s'&quot;  
</PRE>
</P>
<P>ラッパースクリプトは問い合わせをコマンドラインから受け付けるようにして一行のメッセージを返すようにしてください。マッチした応答はそれぞれ一つの行になり、それぞれの行はタブで区切られたアドレス、それから名前、それから他の付加的な情報という風に並べます。エラーが起きたりマッチしたアドレスがなかった場合は0以外のコードを返すようにして一行のエラーメッセージを返すようにしてください。</P>
<P>複数の応答の出力の例:</P>
<P>
<PRE>
Searching database ... 20 entries ... 3 matching:  
me@cs.hmc.edu           Michael Elkins  mutt dude 
blong@fiction.net       Brandon Long    mutt and more 
roessler@guug.de        Thomas Roessler mutt pgp 
</PRE>
</P>
<P>Mutt では問い合わせ機能を利用するのに2つの仕組みが用意されています。一つはインデックスメニューから問い合わせ機能(初期値:
Q)を使う方法です。これを使うとまず問い合わせのプロンプトを表示し、それからマッチした応答のリストを問い合わせメニューに表示します。問い合わせメニューでエイリアスを作成する宛先や今からメールを出す宛先を選択することができます。また複数にメッセージを送るためにタグつけすることも、新たに問い合わせを始めることも、今の応答に加えてさらに問い合わせをすることもできます。</P>
<P>もう一つの問い合わせ機能を利用する仕組みはアドレスの補完で、エイリアスの補完によく似ています。アドレスを入力するすべてのプロンプトで今タイプしようとしているアドレスに基づいて問い合わせを実行し、問い合わせ補完
(complete-query function / 初期値: ^T)を使うことができます。エイリアス
の時と同じように Mutt は最後にスペースかコンマを打った場所まで戻ってタイプされたアドレスを検索します。問い合わせに対して一つだけの応答があった場合その場でそのアドレスが展開されます。複数の応答があった場合は問い合わせメニューを呼び出します。問い合わせメニューで一つもしくは複数のア
ドレスを選択してプロンプトに追加することができます。</P>
<H2><A NAME="ss4.6">4.6</A> <A HREF="manual_ja.html#toc4.6">メールボックスの形式</A>
</H2>

<P>Muttは mbox、MMDF、MH、Maildirの4つの異なるメールボックスの形式をサポートし、読み書きできます。メールボックスのタイプは自動的に判定されるので異なるメールボックスのタイプを指定するフラグを使う必要はありません。新しいメールボックスを作成するときは
<A HREF="manual_ja-6.html#mbox_type">$mbox_type</A>変数で指定されているタイプがデフォルトとして使われます。</P>
<P>
<DL>
<DT><B>mbox</B><DD><P>これは UNIX でもっとも広く使われているメールボックスの形式です。すべてのメールは一つのファイルに格納されます。それぞれのメールは次の形式の行を含み、この行が区切りとなり新しいメールが始まります。
<PRE>
From me@cs.hmc.edu Fri, 11 Apr 1997 11:44:56 PST  
 
</PRE>
</P>
<P>この行はよく From_ 行と呼ばれます。</P>
<DT><B>MMDF</B><DD><P>これは mbox 形式の変形で、それぞれのメールは ^A^A^A^A
(4つの Ctrl-A)を含む行で囲まれます。</P>
<DT><B>MH</B><DD><P>mbox と MMDF を大幅に革新したものです。メールボックスはディレクトリーからなりそれぞれのメールは別々のファイルに格納されます。ファイル名はメール番号を示します(しかし、この番号は
Muttが表示する番号とは一致しない場合もあります)。削除されたメールはファイル名の先頭にコンマ(,)がつけられます。<B>注意</B>:
Mutt は .mh_sequences か .xmhcache というファイルがあるかどうかで
MHメールボックスであると判断します(これらのファイルは普通のディレクトリと
MHメールボックスを区別するのに必要です)。これらのファイルは muttによってアップデートはされません。</P>
<DT><B>Maildir</B><DD><P>最新のメールボックスの形式で、Qmail という MTA
で使われています(Qmail は sendmail を置き換える MTA です)。MH とよく似ていますが、メールボックスのサブディレクトリーとして、tmp、new、curという3つのディレクトリが加えられます。ファイル名は、たとえ他のプログラムが
NFS を通して書き込んでも唯一であるような方法でつけられます。つまりファイルをロックする必要がありません。</P>
</DL>
</P>
<H2><A NAME="shortcuts"></A> <A NAME="ss4.7">4.7</A> <A HREF="manual_ja.html#toc4.7">メールボックスへのショートカット</A>
</H2>

<P>特定のメールボックスを参照するために定義済みのショートカットがたくさんあります。これらのショートカットはファイルやメールボックスのパスを入力するところならばどこでも使うことができます。</P>
<P>
<UL>
<LI>!  -- 
<A HREF="manual_ja-6.html#spoolfile">$spoolfile</A>メールボックスを参照します</LI>
<LI>&gt;  -- 
<A HREF="manual_ja-6.html#mbox">$mbox</A>ファイルを参照します</LI>
<LI>&lt; -- 
<A HREF="manual_ja-6.html#record">$record</A>ファイルを参照します</LI>
<LI>-または!! -- 最後に訪れたファイルを参照します</LI>
<LI><CODE>~</CODE> -- ホームディレクトリを参照します</LI>
<LI>=または + -- 
<A HREF="manual_ja-6.html#folder">$folder</A>ディレクトリを参照します</LI>
<LI>@alias -- エイリアスのアドレスで定義される「セーブを行うデフォルトのフォルダー」
<A HREF="manual_ja-3.html#save-hook">default save folder</A>を参照します。</LI>
</UL>
</P>
<H2><A NAME="using_lists"></A> <A NAME="ss4.8">4.8</A> <A HREF="manual_ja.html#toc4.8">メーリングリストを扱う</A>
</H2>

<P>Muttには大量のメールを扱うための設定オプションがいくつかあります。まず第一に
Muttにどれがメーリングリストのアドレスであるか(技術的にはメーリングリストのアドレスである必要はありませんが、そういった用途で一番よく使われます)、どれが購読しているメーリングリストであるか教えてやります。これは
<A HREF="manual_ja-3.html#lists">lists and subscribe</A>コマンドを muttrc に書いて設定 します。</P>
<P>そうして Mutt にどれがメーリングリストであるか教えてやるといくつかのことが可能になります。まず第一にそのリスト名をインデックスメニューで表示させることができるようになります。これは個人的なメールとメーリングリスト宛てのメールが同じメールボックスにあるときに区別するのに役立ちます。それから
<A HREF="manual_ja-6.html#index_format">$index_format</A>変数での %L というエスケープはメーリングリストがあった場合は
To &lt;list&gt; という文字列を返します。そして CC フィールドにリスト名があった場合は
Cc &lt;list&gt; という文字列を返します(そうでなければメー ルの著者の名前を返します)。</P>
<P>しばしばメーリングリストのメールは To と Cc フィールドが膨大になっている傾向があります。ほとんどの人はメーリングリストで返信するときにわざわざ元の著者のアドレスを削除しようとはしません。結果として二つもしくはそれ以上のコピーがその人に送られてしまうことになります。インデックスメニューとページャーでデフォルトでは
L キーに割り当てられている list-reply 機能 はすべての受信者に返信するのではなくメーリングリストのアドレスにのみ返信することで混乱を減らすことを手助けしてくれます。（<CODE>Mail-Followup-To</CODE>で指定した場合は例外です。以下を見てください）。</P>
<P>Muttは <CODE>Mail-Followup-To</CODE>へッダもサポートしています。
<A HREF="manual_ja-6.html#followup_to">$followup_to</A>変数がセットしてあれば、メールを（メーリングリストへも含めて）何人もの人へ送る場合
Mail-Followup-Toへッダがメールに追加され、それにはすべてのそのメールの受取人が含まれますがあなたのメールアドレスは含まれません。これによってそのメールへの
group-repliesまたは list-replies（つまり followupです）は元々のメールの受取人に送られるのですが、あなたに別に送られることはありません。あなたには、購読しているメーリングリストを通して送られます。</P>
<P>反対に <CODE>Mail-Followup-To</CODE>へッダがついているメッセージに対して group-replyまたは
list-replyをする場合には、
<A HREF="manual_ja-6.html#honor_followup_to">$honor_followup_to</A>変数がセットされている場合にのみこのへッダを使います。この場合には<CODE>Mail-Followup-To</CODE>の受取人のリストに含まれていなくても list-replyはメーリングリストへも返信します。</P>
<P>へッダの編集が可能になっている場合には、自分で <CODE>Mail-Followup-To</CODE>へッダをつけることができます。Muttは送信時にこのへッダが無い場合のみ、このへッダを自動生成します。</P>
<P>もう一つの方法は Reply-To フィールドをメールの著者に設定するのではなく、メーリングリストのアドレスに設定することです。いくつかのメーリングリストの管理者はこの方法を採用しています。この方法はメールの著者に個人的に返信しようとするときに問題が生じます。というのはほとんどのメールクライアントは返信の動作を行うときには自動的に
Reply-To フィールドに設定してあるアドレスを拾ってくるからです。Mutt
では 
<A HREF="manual_ja-6.html#reply_to">$reply_to</A>変数を利用することでどのアドレスに返信するかどうかを決めるのを楽にすることができます。もしセットされていれば
Reply-Toフィールドに指定されているアドレスに返信するか、 Fromフィールドのアドレスに返信するかを問い合わせてくれます。セットされていない場合は
Reply-Toフィールドがあればそれが使われます。</P>
<P>X-Labelフィールドを使ってさらにメーリングリストや話題を特定することができます。
<A HREF="manual_ja-6.html#index_format">$index_format</A>変数の
%yと %Yは X-Label:フィールドをインデックスに展開するのに使えます。また
Muttの正規表現を使ったパターンマッチは標準的なへッダフィールドにしか使えませんが、procmailなどのメールフィルタを使えば簡単に標準的なフィールドに挿入できます。</P>
<P>最後に、Muttはメールボックスをスレッド
<A HREF="manual_ja-2.html#threads">threads</A>でソート
<A HREF="manual_ja-6.html#sort">sort</A>することができます。一つのスレッドは同じ主題で関連するすべてのメールの一まとまりです。普通は一つのメールとそれに返信したすべてのメールが図形的に木のような構造で構成されます。もしスレッド機能を持ったニュースクライアントを使ったことがあるならばわかると思いますがそれと同じコンセプトです。これを利用すると、興味のない話題はスレッド毎に削除でき、また素早く話題の重要性を判断できるのでかなりの流量があるメーリングリストを簡単に扱えるようになります。</P>
<H2><A NAME="ss4.9">4.9</A> <A HREF="manual_ja.html#toc4.9">配送状態の通知(DSN)のサポート</A>
</H2>

<P>RFC1894 では電子メールのメッセージの状態に関する情報の伝えるための
MIME コンテントタイプが定められています。これらは「受取証が戻ってくる」と考えることができます。バークレー
sendmail 8.8.x はメールクライアントがどのタイプの状態メッセージを返させるか要求できるようにいくつかのコマンドラインオプションを備えています。</P>
<P>これをサポートするために二つの変数が用意されています。 
<A HREF="manual_ja-6.html#dsn_notify">$dsn_notify</A>は通常と異なったことが起ったことを通知する受取証を要求するのに使われます(メールが失敗した旨の通知、メールが配送された旨の通知等々)。
<A HREF="manual_ja-6.html#dsn_return">$dsn_return</A>は受取証とともに戻ってくる元のメールの量を限定するように要求できます(ヘッダーもしくはすべてのメール)。DSN
に関するさらに詳しい情報に関しては sendmailの man ページをご覧下さい。</P>
<H2><A NAME="ss4.10">4.10</A> <A HREF="manual_ja.html#toc4.10">POP3 サポート(オプション)</A>
</H2>

<P>Mutt が POP3 のサポート付きでコンパイルされていた場合(configure
スクリプトを --enable-pop フラグをつけて走らせていた場合)、リモート
POP3サーバーにあるメールボックスを操作し、またローカルで閲覧するためにこちらにメッセージを取得することができるようになります。</P>
<P>フォルダ <CODE>pop://popserver/</CODE>を選択するとリモート POP3メールボックスにアクセスできます。</P>
<P>通常とちがうポートを使っている場合にはサーバとともにポートも指定します。つまり
<CODE>pop://popserver:port/</CODE>という形です。</P>
<P>各々のフォルダにちがうユーザ名でアクセスすることもできます。<CODE>pop://username@popserver[:port]/</CODE>としてください。</P>
<P>新しいメールが届いているかどうかを確かめるのは POP3経由ではローカルの場合よりも資源を使います。このため
Muttはリモートでメールチェックする間隔を 
<A HREF="manual_ja-6.html#pop_checkinterval">$pop_checkinterval</A>変数でコントロールします。デフォルトは60秒です。</P>
<P>もし Muttが SSLサポートつきでコンパイルされていた場合（<I>--with-ssl</I>フラグをつけて
<I>configure</I>スクリプトを走らせます）、POP3サーバへの接続を暗号化できます。フォルダに
POP3/SSLでアクセスするには popsという接頭辞をつけます。<CODE>pops://[username@]popserver[:port]/
としてください。</CODE></P>
<P>これ以外の POP3メールにアクセスする方法は <I>fetch-mail</I>機能（デフォルトでは
Gに割り当てられています）です。これは
<A HREF="manual_ja-6.html#pop_host">pop_host</A>で指定されているホストに接続して、すべての新着メールを取ってきてそれをローカルの
<A HREF="manual_ja-6.html#spoolfile">spoolfile</A>に格納します。この後
Mutt はメールがずっとローカルにあったかのように正確に振る舞うことができるようになります。</P>
<P><B>注意</B>: もしすべてのメッセージをローカルメールボックスに持ってきたいだけなら、
<A HREF="http://www.ccil.org/~esr/fetchmail">fetchmail</A>などのそれに特化したプログラムを使うことを考えた方がいいでしょう。</P>
<H2><A NAME="ss4.11">4.11</A> <A HREF="manual_ja.html#toc4.11">IMAP サポート(オプション)</A>
</H2>

<P>Muttが IMAPサポート付きでコンパイルされていれば(configure スクリプトを
--enable-imap フラグをつけて走らせていた場合)、リモート IMAP サーバー上にあるフォルダーを扱うことができるようになります。</P>
<P><CODE>imap://imapserver/INBOX</CODE> フォルダーを選択することでリモートのインボックスにアクセスすることができます。ここで
<CODE>imapserver</CODE> は IMAP サーバーの名前で <CODE>INBOX</CODE> は IMAP サーバーのスプールメールボックスの特別な名前です。もし
IMAP サーバー上の他のメールフォルダーにアクセスしたい場合は、 <CODE>imap://imapserver/path/to/folder</CODE>
と指定しなければなりません。ここで path/to/folder はアクセスしたいフォルダのバスです。</P>
<P>デフォルトではないポートを選ぶこともできます。<CODE>imap://imapserver:port/INBOX</CODE>のように指定してください。</P>
<P>また各々のフォルダを別のユーザー名でアクセスすることもできます。次のように指定してください。<CODE>imap://username@imapserver[:port]/INBOX</CODE>.</P>

<P>SSLのサポートつきで Muttをコンパイルした場合（<I>configure</I>スクリプトに
<I>--enable-ssl</I>フラグをつけた場合）IMAPサーバへの接続を暗号化できます。当然サーバ側も
SSLで暗号化した接続をサポートしている必要があります。IMAP/SSLを使ってフォルダにアクセスする場合はフォルダパスに
<CODE>imaps://[username@]imapserver[:port]/path/to/folder</CODE>と指定しなければなりません。</P>
<P>Pineの場合と同じ書き方も使うことができます。<CODE>{[username@]imapserver[:port][/ssl]}path/to/folder
というような書き方です。</CODE></P>
<P>すべてのサーバで / が階層を分けるのに使われているわけではないことに注意してください。Muttはサーバで使われているセパレータが何かを認識してそれに応じてフォルダパスを変換してくれるはずです。</P>
<P>一つの IMAPサーバ上のフォルダを見る場合、購読しているフォルダだけを見ることもすべてのフォルダを見ることも
<I>toggle-subscribed</I>コマンドを使ってできます。
<A HREF="manual_ja-6.html#imap_list_subscribed">$imap_list_subscribed</A>変数も参照してください。</P>
<P>新しいメールが来たかどうかを IMAPを通して確かめるのはかなりの遅れが生じます。そのために
<A HREF="manual_ja-6.html#mail_check">$mail_check</A>変数と
<A HREF="manual_ja-6.html#timeout">$timeout</A>変数を注意深く設定する必要があるかもしれません。私は個人的には</P>
<P>
<PRE>
set mail_check=90  
set timeout=15 
</PRE>
</P>
<P>という設定を遅い電話線経由で使ってますが、まあまあよい結果を得ています。</P>
<P>UWサーバの v12.250より前のバージョンでメールを保存するのに mboxを使っている場合には他のクライアントが同じフォルダを選ぶと今そのフォルダを使っているクライアントの接続を切るようにサーバに通知されます。注意してください。</P>
<H3>フォルダブラウザ</H3>

<P>Muttはバージョン 1.2から IMAPサーバ上のメールボックスのブラウズをサポートしました．これはほとんどローカルの場合と同じですが、以下のような違いがあります。</P>
<P>
<UL>
<LI>ファイルの属性の代わりに IMAPという文字列を表示します。これの後ろにプラス(+)サインがつく場合がありますが、これはこの中にメッセージとサブフォルダの両方が含まれていることを意味します。Cyrus
またはそれに似たサーバの場合にはしばしばフォルダの中にメッセージとサブフォルダが入っています。</LI>
<LI>フォルダにメッセージとサブフォルダの両方が含まれている場合には、（デフォルトでは<CODE>enter</CODE>に割り当てられている）selectionキーを押すとその下のサブフォルダに入ります。もしそのフォルダのメッセージを見たい場合には（デフォルトでは
<CODE>space</CODE>に割り当てられている）<CODE>view-file</CODE>を使わなければなりません。</LI>
<LI>メールボックスを消すには <CODE>delete-mailbox</CODE>コマンド（デフォルトでは
d）を使います。<CODE>subscribe、unsubscribeコマンドを使ってメールボックスの購読、購読の取り消しができます。デフォルトではこれらのコマンドは
sと uに割り当てられています。</CODE></LI>
</UL>
</P>
<H3>認証</H3>

<P>Muttは IMAPサーバの認証形式として SASL、GSSAPI、CRAM-MD5、 LOGINをサポートしています（Grant
Edwardsがかわいそうな exchange ユーザのために NTLM認証を加えるパッチを書いてくれましたが、まだメインツリーには統合されていません
）。また疑似プロトコル ANONYMOUSもサポートしています。これは自分のアカウントがない公開
IMAPサーバにログインするためのもので、ANONYMOUSを使うにはユーザ名を空白、または
anonymousにしてください。</P>
<P>SASLは特別な認証形式で、これはあなたのホストとサーバで利用可能ないくつかのプロトコル（GSSAPI、CRAM-MD5、ANONYMOUS、
DIGEST-MD5を含みます）の中から一番安全な方法を選びます。これらのうちのいくつかの方法（DIGEST-MD5と多分
GSSAPI）では、セッション全体が暗号化され通信を覗かれても大丈夫になります。SASLが使えるならできるだけこれを使いましょう。これを使うには
Cyrus SASLライブラリが必要で、muttをコンパイルするときに <I>--with-sasl</I>フラグをつけてください。</P>
<P>Muttは SASL、 ANONYMOUS、 GSSAPI、 CRAM-MD5、 LOGINの順番でどの方法が利用可能なのかを調べます。</P>
<P>認証形式をコントロールするいくつかの変数があります。</P>
<P>
<UL>
<LI>
<A HREF="manual_ja-6.html#imap_user">$imap_user</A> - すべての認証形式で認証に使うユーザ名です。この設定よりもメールボックスのパスに明示的に含まれるユーザ名（<CODE>つまり
{user@host}</CODE>の形のメールボックスの指定です）の方が優先します。</LI>
<LI>
<A HREF="manual_ja-6.html#imap_pass">$imap_pass</A> - パスワードを必要とするすべての認証形式で認証に使うパスワードを設定します。</LI>
<LI>
<A HREF="manual_ja-6.html#imap_authenticators">$imap_authenticators</A> - コロンで区切られた IMAPサーバへの認証方法のリストです。この順に認証方法を試していきます。この変数が設定されている場合は
muttのデフォルト（上で書いた順序ですべての方法で試す）を上書きします。</LI>
</UL>
</P>
<H2><A NAME="account-hook"></A> <A NAME="ss4.12">4.12</A> <A HREF="manual_ja.html#toc4.12">複数の IMAP/POP アカウントを使う (OPTIONAL)</A>
</H2>

<P>いくつもの IMAPや POPサーバにアカウントを持っていると、認証のための設定が面倒で間違いを起こしやすくなります。そんなときは、account-hookを使えばいいでしょう。account-hookコマンドは
folder-hookコマンドと同じように働きますが、メールボックスを開くときだけでなく、リモートのメールボックスにアクセスするときはいつも呼び出されます（フォルダブラウザ内も含みます）。</P>
<P>いくつかの例を見てください。</P>
<P>
<PRE>
account-hook . 'unset imap_user; unset imap_pass; unset tunnel'  
account-hook imap://host1/ 'set imap_user=me1 imap_pass=foo' 
account-hook imap://host2/ 'set tunnel=&quot;ssh host2 /usr/libexec/imapd&quot;' 
</PRE>
</P>
<H2><A NAME="urlview"></A> <A NAME="ss4.13">4.13</A> <A HREF="manual_ja.html#toc4.13">WWW ブラウザーを起動して URL の場所に行く</A>
</H2>

<P>メールに URL(<EM>unified resource locator</EM> = http://www.mutt.org/
のような WWW空間の住所)が含まれている場合は、それらすべての URL を含むメニューを表示させてそこから一つ選んで
WWW ブラウザーを起動してそこに行くのが効率的ですよね。この機能は外部の
urlviewプログラムによって提供されます。 urlviewプログラムは 
<A HREF="ftp://ftp.guug.de/pub/mutt/contrib/">ftp://ftp.guug.de/pub/mutt/contrib/</A>で手に入れることができます。またこれを使うための設定コマンドは:</P>
<P>
<PRE>
macro index \cb |urlview\n  
macro pager  \cb |urlview\n
</PRE>
</P>
<P>です。</P>
<HR>
<A HREF="manual_ja-5.html">次のページ</A>
<A HREF="manual_ja-3.html">前のページ</A>
<A HREF="manual_ja.html#toc4">目次へ</A>
</BODY>
</HTML>
